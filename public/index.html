<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Electricity bills downloader</title>
    <link rel="stylesheet" href="http://localhost:4600/css/styles.css">
    <link rel="icon" sizes="32x32" href="http://localhost:4600/images/favicon.ico">
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
    <nav>
        <img src="http://localhost:4600/images/apple-touch-icon.png" alt="logo" class="logo">
        <span>Electricity Bill Downloader
        </span>
    </nav>
    <div class="nav-bottom"></div>
    
    <div class="container">
        <input type="file" name="excel" id="excel_file">
        <button id="start" onclick="uploadFile()">Start Downloading</button>
    </div>
    
    <div class="list-container">
        <ul id="success-list">
        </ul>
        <ul id="error-list">
        </ul>
    </div>

    <script>
        // var socket = io();

        // socket.on('process-started', function(){

        //     let loader = document.createElement('div');
        //     loader.classList.add("lds-hourglass");
        //     loader.classList.add("loader-center");
        //     document.body.appendChild(loader);
            
        //     let startButton = document.querySelector('#start');
        //     start.classList.add('disabled');
        //     start.disabled = true;
        // })

        // socket.on('pdf-generated', (arg) => {
        //     let li = document.createElement("li");
        //     let signDiv = document.createElement('div');
        //     signDiv.classList.add('sign_div');
        //     let signImg = document.createElement('img');
        //     signImg.setAttribute('type', "images/svg");
        //     signImg.setAttribute("src", "http://localhost:4600/images/check.svg");
        //     signImg.setAttribute("alt", "sign image")
        //     signDiv.appendChild(signImg);
        //     let messageDiv = document.createElement('div');
        //     let messageTextNode = document.createTextNode(`Pdf generated for ${arg.billMonth} for consumer ${arg.consumer}`);
        //     messageDiv.appendChild(messageTextNode);
        //     li.appendChild(signDiv);
        //     li.appendChild(messageDiv);
        //     document.querySelector('#success-list').appendChild(li);
        // })

        // socket.on('pdf-error', arg => {
        //     let li = document.createElement("li");
        //     li.classList.add('error');
        //     let signDiv = document.createElement('div');
        //     signDiv.classList.add('sign_div');
        //     let signImg = document.createElement('img');
        //     signImg.setAttribute('type', "images/svg");
        //     signImg.setAttribute("src", "http://localhost:4600/images/cross.svg");
        //     signImg.setAttribute("alt", "sign image")
        //     signDiv.appendChild(signImg);
        //     let messageDiv = document.createElement('div');
        //     let messageTextNode = document.createTextNode(`Error : ${arg.message} while downloading pdf for consumer ${arg.consumer}`);
        //     messageDiv.appendChild(messageTextNode);
        //     li.appendChild(signDiv);
        //     li.appendChild(messageDiv);
        //     document.querySelector('#error-list').appendChild(li);
        // })

        // socket.on('waiting-for-user', function () {
        //     let button = document.createElement("button");
        //     let buttonTextNode = document.createTextNode(`Process Completed`);
        //     button.classList.add('complete-button');
        //     button.appendChild(buttonTextNode);
        //     button.addEventListener('click', () => socket.emit('response-from-user'));
        //     document.querySelector('body').appendChild(button);

        //     let loader = document.body.querySelector(".lds-hourglass");
        //     loader.parentElement.removeChild(loader);            

        //     let startButton = document.querySelector('#start');
        //     start.classList.remove('disabled');
        //     start.disabled = false;
        // })

        // socket.on('file-error', function (error) {
        //     let ul = document.createElement("ul");
        //     ul.setAttribute("id", "pdf-error");
            
        //     let li = document.createElement("li");
        //     li.classList.add('error');
        //     let signDiv = document.createElement('div');
        //     signDiv.classList.add('sign_div');
        //     let signImg = document.createElement('img');
        //     signImg.setAttribute('type', "images/svg");
        //     signImg.setAttribute("src", "http://localhost:4600/images/cross.svg");
        //     signImg.setAttribute("alt", "sign image")
        //     signDiv.appendChild(signImg);
        //     let messageDiv = document.createElement('div');
        //     let messageTextNode = document.createTextNode(`Error : ${error}`);
        //     messageDiv.appendChild(messageTextNode);
        //     li.appendChild(signDiv);
        //     li.appendChild(messageDiv);
        //     ul.appendChild(li);

        //     document.querySelector('body').appendChild(ul);
        // })

        // socket.on('perform-cleanup', function () {
        //     let pdfError = document.querySelector('#pdf-error');
        //     pdfError && pdfError.parentNode.removeChild(pdfError);
        //     let completeButton = document.querySelector('.complete-button');
        //     completeButton && completeButton.parentNode.removeChild(completeButton);
        //     let successList = document.querySelector('#success-list');
        //     if (successList) {
        //         while (successList.hasChildNodes()) {
        //             successList.removeChild(successList.childNodes[0]);
        //         }
        //     }
        //     let errorList = document.querySelector('#error-list');
        //     if (errorList) {
        //         while (errorList.hasChildNodes()) {
        //             errorList.removeChild(errorList.childNodes[0]);
        //         }
        //     }
        // })

        // async function uploadFile() {
        //     let formData = new FormData();
        //     let excel = document.getElementById("excel_file").files[0];
        //     formData.append("excel", excel);
        //     // formData.append("downloadPath", downloadPath);

        //     try {
        //         let r = await fetch('/file', { method: "POST", body: formData });
        //         console.log('HTTP response code:', r.status);
        //     } catch (e) {
        //         console.log('Huston we have problem...:', e);
        //     }


        // }
    </script>
    <script src="http://localhost:4600/js/client.js"></script>
</body>

</html>